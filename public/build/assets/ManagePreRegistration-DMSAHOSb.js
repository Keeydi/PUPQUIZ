import{q as D,r as k,j as e,b as I,R as B,a as P}from"./app-Bw7SI7Zc.js";import{A as U}from"./AuthenticatedLayout-CI3V53ad.js";import{B as j}from"./button-DfuBJou0.js";import{S as d}from"./sweetalert2.esm.all-ePrzfkxH.js";import{L as O}from"./layout-dashboard-CYlHiTZm.js";import{S as _}from"./search-4Os3sXOG.js";import{U as H}from"./user-DHJgBjiT.js";import{H as V,B as z}from"./hash-jwVQodHO.js";import{U as F}from"./users-Cf7dCBKJ.js";import{C as Y}from"./chevron-up-Cxu9kMVs.js";import{C as J}from"./chevron-down-BEE1iTxm.js";import{E as W}from"./eye-BvcIt5V3.js";import{c as G}from"./createLucideIcon-ZzUTTAV8.js";import"./transition-Cvj0qrZa.js";import"./render-CkrE6gxv.js";import"./index-BhOk6Dy5.js";import"./clsx-B-dksMZM.js";import"./utils-CP3_-lCt.js";/**
 * @license lucide-react v0.507.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m3 15 2 2 4-4",key:"1lhrkk"}]],Q=G("file-check-2",K),y=f=>{if(!f)return"";const m=String(f).trim();return/^https?:\/\//i.test(m)||m.startsWith("/")?m:`/storage/${m}`};function fe({}){const f=D(),{lobby:m,pre_registration:E}=f.props,v=E||[],[S,L]=k.useState(""),[$,q]=k.useState(new Set),N=v.filter(s=>{const r=s.team??"",a=s.team_leader??"",n=S.trim().toLowerCase();return n?String(r).toLowerCase().includes(n)||String(a).toLowerCase().includes(n):!0}),C=async(s,r)=>{var t,x,h,u,b,w;const{value:a}=await d.fire({title:`${s} Participant`,input:"textarea",inputLabel:"Enter your comment (optional)",inputPlaceholder:"Write your comment here...",inputAttributes:{"aria-label":"Write your comment here"},showCancelButton:!0,confirmButtonText:`Yes, ${s}`,cancelButtonText:"Cancel",icon:s==="Reject"?"warning":"question",confirmButtonColor:s==="Reject"?"#d33":"#3085d6"});if(a===void 0)return;const n=new FormData;n.append("lobby_id",String(m.id)),n.append("status",s==="Reject"?"1":"2"),n.append("participant_id",String(r)),n.append("comment",a||"");try{d.fire({title:"Please wait...",text:`${s==="Approved"?"Approving":s} participant...`,allowOutsideClick:!1,didOpen:()=>d.showLoading()});const i=await P.post("/manage-pre-registration",n);d.close(),(t=i.data)!=null&&t.success?((x=document.getElementById(`pre-reg-${r}`))==null||x.remove(),await d.fire({icon:"success",title:"Success!",text:i.data.message,confirmButtonColor:"#3085d6"})):await d.fire({icon:"error",title:"Error",text:((h=i.data)==null?void 0:h.message)||"Something went wrong."})}catch(i){d.close(),console.error(((u=i==null?void 0:i.response)==null?void 0:u.data)||(i==null?void 0:i.message)),await d.fire({icon:"error",title:"Request Failed",text:((w=(b=i==null?void 0:i.response)==null?void 0:b.data)==null?void 0:w.message)||"Unable to process the request."})}},R={studentId:"Valid Student ID",registrationForm:"Certificate of Registration Form",consentForm:"Signed Consent Form"},A=(s=[])=>!Array.isArray(s)||s.length===0?'<div class="mb-2 p-2 text-sm text-gray-600 italic">No files uploaded.</div>':s.map(r=>{const a=r.url||"",n=(r.name||"Untitled").replace(/\s*\(.*?\)\s*/,""),t=R[n]||n,x=(a.split(".").pop()||"").toLowerCase();if(!a||a==="null"||a==="undefined"||a.trim()===""||a.includes("null")||a.includes("undefined"))return`<div class="file-card w-1/3 p-2"><h4 class="file-title text-black">${t}</h4><div>No file uploaded ❌</div></div>`;const h=x==="pdf",u=["jpg","jpeg","png","gif","webp","svg"].includes(x);return h?`
            <div class="file-card w-1/3 p-2">
              <div class="file-inner">
                <h4 class="file-title text-black">${t}</h4>
                <iframe src="${a}" class="rounded-lg shadow-sm mb-2" style="width:100%; height:200px;"></iframe>
                <button onclick="window.open('${a}', '_blank')" class="w-full bg-orange-500 text-white py-1.5 rounded-lg text-sm hover:bg-orange-600 transition">View Full PDF</button>
              </div>
            </div>
          `:u?`
            <div class="file-card w-1/3 p-2">
              <div class="file-inner">
                <h4 class="file-title text-black mb-2">${t}</h4>
                <div class="relative group rounded-lg overflow-hidden" style="width:100%; height:200px;">
                  <img src="${a}" class="file-image w-full h-full object-cover cursor-pointer" onclick="window.open('${a}', '_blank')" alt="${t}" />
                  <span class="absolute inset-0 flex items-center justify-center text-white text-sm bg-orange-500 bg-opacity-80 opacity-0 group-hover:opacity-100 transition pointer-events-none">Click to see full size</span>
                </div>
              </div>
            </div>
          `:`
          <div class="w-1/3 p-2 text-center">
            <h4 class="font-semibold text-gray-700 mb-2">${t}</h4>
            <p class="text-red-400 mb-2">❗File type not supported for preview.</p>
          </div>
        `}).join(""),M=s=>{const r=s.participant??s;let a=[];try{const l=r.members??s.members??"[]";a=Array.isArray(l)?l:JSON.parse(String(l||"[]")),Array.isArray(a)||(a=[])}catch(l){console.error("Error parsing members JSON:",l),a=[]}const n=[];r.requirements&&typeof r.requirements=="object"?Object.entries(r.requirements).forEach(([l,o])=>{const c=y(String(o??"")),p=(c.split(".").pop()||"").toLowerCase()==="pdf"?"pdf":"image";n.push({name:`${l} (${r.team_leader??r.name??"Team Leader"})`,url:c,type:p})}):[{label:"Valid Student ID",value:r.student_number??r.student_id??null},{label:"Certificate of Registration Form",value:r.registration_form??null},{label:"Signed Consent Form",value:r.consent_form??null}].forEach(o=>{if(o.value){const c=y(String(o.value));n.push({name:`${o.label} (${r.team_leader??r.name??"Team Leader"})`,url:c})}}),a.forEach(l=>{const o=l.requirements??{};Object.entries(o).forEach(([c,p])=>{const g=y(String(p??""));n.push({name:`${c} (${l.name??"Member"})`,url:g})})});const t=n.reduce((l,o)=>{var g;const c=(g=o.name)==null?void 0:g.match(/\((.*?)\)/),p=c?c[1]:"Unknown";return l[p]||(l[p]=[]),l[p].push(o),l},{}),x=r.team_leader??r.name??"Team Leader",h=t[x]??[],u=`
      <div class="p-4 border-2 rounded-lg bg-orange-50 mb-4">
        <h2 class="text-2xl font-bold text-orange-600 mb-4 flex items-center gap-2">Team Leader Information</h2>
        <p class="flex items-center gap-2 text-black"><strong>Full Name:</strong> ${r.team_leader??r.name??"N/A"}</p>
        <p class="flex items-center gap-2 mt-2 text-black"><strong>Student ID:</strong> ${r.student_number??r.student_id??"N/A"}</p>
        <p class="flex items-center gap-2 mt-2 text-black"><strong>Section:</strong> ${r.course_year??r.section??"N/A"}</p>
        <p class="flex items-center gap-2 mt-2 text-black"><strong>Email:</strong> ${r.team_leader_email??r.email??"N/A"}</p>
        <p class="flex items-center gap-2 mt-2 text-black"><strong>Contact Number:</strong> ${r.contact_number??"N/A"}</p>
      </div>
    `,b=`
      <div class="mb-6 p-4 border rounded-lg bg-orange-50">
        <h3 class="text-xl font-bold text-orange-600 mb-4">Submitted Requirements (Team Leader)</h3>
        <div class="flex flex-wrap -m-2">
          ${A(h)}
        </div>
      </div>
    `,w=a.map((l,o)=>{const c=l.name??"N/A",p=l.studentNumber??l.student_number??"N/A",g=l.courseYear??l.course_year??"N/A",T=t[c]??[];return`
          <div class="p-4 border-2 rounded-lg bg-orange-50 mb-4">
            <h2 class="text-2xl font-bold text-orange-600 mb-3">Member No. ${o+1} Information</h2>
            <p class="text-black"><strong>Full Name:</strong> ${c}</p>
            <p class="mt-1 text-black"><strong>Student ID:</strong> ${p}</p>
            <p class="mt-1 text-black"><strong>Section:</strong> ${g}</p>
          </div>

          <div class="p-4 border rounded-lg bg-orange-50 mb-6">
            <h3 class="text-xl font-bold text-orange-600 mb-4">Submitted Requirements (Member)</h3>
            <div class="flex flex-wrap -m-2 ">
              ${A(T)}
            </div>
          </div>
        `}).join(""),i=`
      ${b}
      ${w}
    `;d.fire({title:`
        <span class="text-4xl font-bold text-gray-900 mb-2 bg-gradient-to-r from-red-600 to-amber-600 bg-clip-text text-transparent">
          Participant Information
        </span>
      `,html:`
        <div style="max-height:600px; overflow-y:auto; text-align:left;">
          ${u}
          ${i}
        </div>
      `,width:"80%",showCloseButton:!0,showConfirmButton:!1,customClass:{popup:"swal-wide",htmlContainer:"swal-html-container"},didOpen:()=>{const l=d.getPopup();l==null||l.querySelectorAll("iframe").forEach(o=>{o.setAttribute("sandbox","allow-same-origin allow-scripts allow-popups")})}})};return e.jsx("div",{children:e.jsx(U,{children:e.jsx("div",{className:"min-h-screen bg-white p-6",children:e.jsxs("div",{className:"w-full max-w-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2 bg-gradient-to-r from-red-600 to-amber-600 bg-clip-text text-transparent",children:(m==null?void 0:m.name)??"Lobby"}),e.jsx("p",{className:"text-gray-600",children:"Manage Pre Registration"})]}),e.jsxs("div",{onClick:()=>I.get("/organizerLobby"),className:"bg-red-500 text-white p-4 flex gap-x-3 rounded-md hover:bg-red-700 hover:cursor-pointer",children:[e.jsx(O,{}),e.jsx("p",{children:"Go to Dashboard"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by team name or team leader name...",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors",value:S,onChange:s=>L(s.target.value)})]})})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-red-500 to-amber-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Team Name"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Team Leader"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white",children:"Email"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"Contact Number"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"Members"}),e.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-white w-fit truncate",children:"View Preview"}),e.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-white",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:N.map((s,r)=>{const a=$.has(s.id);let n=[];try{const t=s.members??"[]";n=Array.isArray(t)?t:JSON.parse(String(t||"[]")),Array.isArray(n)||(n=[])}catch(t){console.error("Error parsing members:",t),n=[]}return e.jsxs(B.Fragment,{children:[e.jsxs("tr",{id:`pre-reg-${s.id}`,className:`hover:bg-red-50 transition-colors duration-200 ${r%2===0?"bg-white":"bg-gray-50"}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"w-fit px-8 truncate h-8 bg-gradient-to-r from-red-400 to-amber-400 rounded-full flex items-center justify-center text-white font-semibold text-sm mr-3",children:s.team??"—"})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center w-fit truncate",children:[e.jsx(H,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-900 font-medium uppercase",children:s.team_leader??"N/A"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-gray-900",children:s.team_leader_email??"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"w-4 h-4 text-gray-400 mr-2"}),e.jsx("span",{className:"text-gray-900 font-mono",children:s.contact_number??"N/A"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[n.length," ",n.length===1?"Member":"Members"]}),n.length>0&&e.jsx("button",{onClick:()=>{const t=new Set($);a?t.delete(s.id):t.add(s.id),q(t)},className:"ml-2 text-red-600 hover:text-red-800",children:a?e.jsx(Y,{className:"w-4 h-4"}):e.jsx(J,{className:"w-4 h-4"})})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs(j,{size:"sm",className:"bg-green-600 hover:bg-green-800 flex items-center gap-2",onClick:()=>{try{M(s)}catch(t){console.error("Error viewing files:",t),d.fire({icon:"error",title:"Error",text:"Failed to load files. Please try again.",confirmButtonColor:"#dc2626"})}},children:[e.jsx(W,{className:"w-4 h-4 text-white"}),e.jsx("span",{children:"View"})]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-center items-center gap-2",children:[e.jsxs(j,{size:"sm",className:"bg-blue-600 hover:bg-blue-800 w-32 flex items-center justify-center gap-2",onClick:()=>C("Approved",s.id),children:[e.jsx(Q,{className:"w-4 h-4 text-white"}),e.jsx("span",{children:"Approved"})]}),e.jsxs(j,{size:"sm",className:"bg-red-600 hover:bg-red-800 w-32 flex items-center justify-center gap-2",onClick:()=>C("Reject",s.id),children:[e.jsx(z,{className:"w-4 h-4 text-white"}),e.jsx("span",{children:"Reject"})]})]})})]}),a&&n.length>0&&e.jsx("tr",{className:`${r%2===0?"bg-gray-50":"bg-white"}`,children:e.jsx("td",{colSpan:7,className:"px-6 py-4",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-red-600"}),"Team Members Information"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map((t,x)=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:t.name??`Member ${x+1}`}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Student Number:"})," ",t.studentNumber??t.student_number??"N/A"]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Course/Year:"})," ",t.courseYear??t.course_year??"N/A"]}),t.requirements&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-300",children:[e.jsx("p",{className:"font-medium text-gray-700 mb-1",children:"Requirements:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsxs("li",{className:t.requirements.studentId?"text-green-600":"text-gray-400",children:[t.requirements.studentId?"✓":"✗"," Student ID"]}),e.jsxs("li",{className:t.requirements.registrationForm?"text-green-600":"text-gray-400",children:[t.requirements.registrationForm?"✓":"✗"," Registration Form"]}),e.jsxs("li",{className:t.requirements.consentForm?"text-green-600":"text-gray-400",children:[t.requirements.consentForm?"✓":"✗"," Consent Form"]})]})]})]})]},x))})]})})})]},s.id)})})]})}),N.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(_,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sessions found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or filters."})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-500 text-sm",children:["Showing ",N.length," of ",v.length," Registration"]})})]})})})})}export{fe as default};
